import{d as e,S as n,P as t,W as o,O as a,T as r,a as l,M as s,b as i,w as u,A as d,c as p,r as c,o as m,C as h,e as g,V as f,f as b,g as w,v as y,h as v,F as k,i as $,j as C,t as M,k as N,l as S,m as U}from"./vendor.a2ca8ce2.js";import{graphql as O}from"https://cdn.skypack.dev/@octokit/graphql";let T;const E={};var P=e({name:"ThreeCanvas",props:{users:{type:Array,required:!0}},setup(e){const b=new n,w=new t(75,960/540,.1,1e3),y=new o;y.setSize(960,540);const v=new a;let k;b.add(v);const $=new r;$.load("textures/world-map.jpg",(e=>{const n=new l(2.5,32,32),t=new s({map:e,dithering:!0});k=new i(n,t),v.add(k)})),u((()=>e.users),(e=>{e.filter((e=>Boolean(e.geolocation))).forEach((e=>{const{lat:n,lng:t}=e.geolocation,o=function(e,n,t){const o=(90-n)*(Math.PI/180),a=(t+180)*(Math.PI/180),r=new f;return r.x=-e*Math.sin(o)*Math.cos(a),r.z=e*Math.sin(o)*Math.sin(a),r.y=e*Math.cos(o),r}(2.6,n,t);$.load(e.avatarUrl,(e=>{const n=new h(.2,32),t=new g({map:e}),a=new i(n,t);a.position.set(o.x,o.y,o.z),v.add(a)}))}))}),{deep:!0});const C=new d(16777215,.1);b.add(C);const M=new p(16777215,1);M.position.set(40,15,40),M.angle=Math.PI/4,M.penumbra=.1,M.decay=2,M.distance=200,M.castShadow=!0,M.shadow.mapSize.width=512,M.shadow.mapSize.height=512,M.shadow.camera.near=10,M.shadow.camera.far=200,M.shadow.focus=1,b.add(M),w.position.z=5;const N=c(.001);return function e(){if(requestAnimationFrame(e),k){v.rotation.y-=N.value;for(const e of v.children)e instanceof i&&"CircleGeometry"===e.geometry.type&&(e.rotation.y+=N.value)}y.render(b,w)}(),m((()=>{const e=document.getElementById("canvas");e&&(e.innerHTML="",e.appendChild(y.domElement))})),{rotationSpeed:N}}});const _=v("label",{for:"rotation-speed"},"Rotation speed:",-1),G=v("div",{id:"canvas"},null,-1);function I(e,n,t){console.log(`Found (${e}): ${n.name}, "${n.location}" -> "${t.city}", "${t.adminName}", "${t.country}" (${t.lat}, ${t.lng})`)}P.render=function(e,n,t,o,a,r){return $(),b(k,null,[_,w(v("input",{id:"rotation-speed","onUpdate:modelValue":n[1]||(n[1]=n=>e.rotationSpeed=n),name:"rotation-speed",type:"number",placeholder:"0.001",step:"0.0001"},null,512),[[y,e.rotationSpeed,void 0,{number:!0}]]),G],64)};var L=e({name:"App",components:{ThreeCanvas:P},setup(){const e=c(""),n=c("vitejs"),t=c("vite"),o=c([]),a=c(),r=[],l=e=>{let n;const{location:t}=e;if(!t)return n;let o=999;for(const a of r)a.city===t&&o>1?(n={lat:a.lat,lng:a.lng},o=1,I(o,e,a)):a.adminName===t&&o>2?(n={lat:a.lat,lng:a.lng},o=2,I(o,e,a)):a.country===t&&o>3?(n={lat:a.lat,lng:a.lng},o=3,I(o,e,a)):t.includes(a.city)&&o>4?(n={lat:a.lat,lng:a.lng},o=4,I(o,e,a)):a.adminName&&t.includes(a.adminName)&&o>5?(n={lat:a.lat,lng:a.lng},o=5,I(o,e,a)):t.includes(a.country)&&o>6&&(n={lat:a.lat,lng:a.lng},o=6,I(o,e,a));return n};return u([e,n,t],(async()=>{o.value=[],a.value=void 0;try{let a=!0,r=null;do{const s=await O("\n                query ($repoOwner: String!, $repoName: String!, $after: String) {\n                  repository(owner: $repoOwner, name: $repoName) {\n                    mentionableUsers(first: 100, after: $after) {\n                      nodes {\n                        id\n                        login\n                        name\n                        avatarUrl\n                        location\n                        url\n                      }\n                      pageInfo {\n                        hasNextPage\n                        endCursor\n                      }\n                      totalCount\n                    }\n                  }\n                }\n              ",{headers:{authorization:`token ${e.value}`},repoOwner:n.value,repoName:t.value,after:r});a=s.repository.mentionableUsers.pageInfo.hasNextPage,r=s.repository.mentionableUsers.pageInfo.endCursor;const i=s.repository.mentionableUsers.nodes;if(i.length>0){for(const e of i)e.geolocation=l(e);o.value.push(...i)}}while(a)}catch(r){console.error(r),a.value=r.message}}),{immediate:!0}),m((()=>{(function(e,n){if(!n||0===n.length)return e();if(void 0===T){const e=document.createElement("link").relList;T=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(n.map((e=>{if((e=`/github-contributors-map/${e}`)in E)return;E[e]=!0;const n=e.endsWith(".css"),t=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${t}`))return;const o=document.createElement("link");return o.rel=n?"stylesheet":T,n||(o.as="script",o.crossOrigin=""),o.href=e,document.head.appendChild(o),n?new Promise(((e,n)=>{o.addEventListener("load",e),o.addEventListener("error",n)})):void 0}))).then((()=>e()))})((()=>import("./worldcities.46d1bbb9.js")),[]).then((e=>{r.push(...e.default)}))})),{githubToken:e,repoOwner:n,repoName:t,collaborators:o,errorMessage:a}}});const x=v("h1",null,"GitHub Contributors Map",-1),z=v("p",null,[v("a",{href:"https://github.com/Shinigami92/github-contributors-map",target:"_blank"},"GitHub Repo")],-1),A=v("p",null,[N("You need a GitHub private access token: "),v("a",{href:"https://github.com/settings/tokens/new?description=GitHub%20Contributors%20Map&scopes=public_repo",target:"_blank"},"Generate a personal token")],-1),H=v("label",{for:"personal-github-token"},"Your GitHub Token:",-1),R=v("label",{for:"repo-owner"},"Repository Owner:",-1),V=v("label",{for:"repo-name"},"Repository Name:",-1),j=v("h2",null,"Collaborators",-1),q=v("thead",null,[v("tr",null,[v("th",null,"Avatar"),v("th",null,"Login"),v("th",null,"Name"),v("th",null,"Location"),v("th",null,"URL"),v("th",null,"Geolocation")])],-1);L.render=function(e,n,t,o,a,r){const l=S("ThreeCanvas");return $(),b(k,null,[x,v("div",null,[z,A,v("form",null,[H,w(v("input",{id:"personal-github-token","onUpdate:modelValue":n[1]||(n[1]=n=>e.githubToken=n),name:"personal-github-token",placeholder:"ghp_************************************"},null,512),[[y,e.githubToken]]),R,w(v("input",{id:"repo-owner","onUpdate:modelValue":n[2]||(n[2]=n=>e.repoOwner=n),name:"repo-owner",placeholder:"owner"},null,512),[[y,e.repoOwner]]),V,w(v("input",{id:"repo-name","onUpdate:modelValue":n[3]||(n[3]=n=>e.repoName=n),name:"repo-name",placeholder:"name"},null,512),[[y,e.repoName]])])]),e.errorMessage?($(),b("span",{key:1,textContent:M(e.errorMessage)},null,8,["textContent"])):($(),b(k,{key:0},[j,v(l,{users:e.collaborators},null,8,["users"]),v("table",null,[q,v("tbody",null,[($(!0),b(k,null,C(e.collaborators,(e=>($(),b("tr",{key:e.id},[v("td",null,[v("img",{src:e.avatarUrl,width:"128"},null,8,["src"])]),v("td",null,M(e.login),1),v("td",null,M(e.name),1),v("td",null,M(e.location),1),v("td",null,M(e.url),1),v("td",null,M(e.geolocation),1)])))),128))])])],64))],64)},U(L).mount("#app");
