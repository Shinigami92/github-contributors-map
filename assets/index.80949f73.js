import{d as e,S as n,P as o,W as t,O as a,T as r,a as l,M as s,b as i,w as u,A as d,c,o as p,C as m,e as h,V as g,f as w,g as f,r as v,h as y,i as b,v as k,F as $,j as N,t as C,k as M,l as O}from"./vendor.138b387f.js";import{graphql as E}from"https://cdn.skypack.dev/@octokit/graphql";let P;const T={};var U=e({name:"ThreeCanvas",props:{users:{type:Array,required:!0}},setup(e){const w=new n,f=new o(75,960/540,.1,1e3),v=new t;v.setSize(960,540);const y=new a;let b;w.add(y);const k=new r;k.load("textures/world-map.jpg",(e=>{const n=new l(2.5,32,32),o=new s({map:e,dithering:!0});b=new i(n,o),y.add(b)})),u((()=>e.users),(e=>{e.filter((e=>Boolean(e.geolocation))).forEach((e=>{const{lat:n,lng:o}=e.geolocation,t=function(e,n,o){const t=(90-n)*(Math.PI/180),a=(o+180)*(Math.PI/180),r=new g;return r.x=-e*Math.sin(t)*Math.cos(a),r.z=e*Math.sin(t)*Math.sin(a),r.y=e*Math.cos(t),r}(2.6,n,o);k.load(e.avatarUrl,(e=>{const n=new m(.2,32),o=new h({map:e}),a=new i(n,o);a.position.set(t.x,t.y,t.z),y.add(a)}))}))}));const $=new d(16777215,.1);w.add($);const N=new c(16777215,1);N.position.set(40,15,40),N.angle=Math.PI/4,N.penumbra=.1,N.decay=2,N.distance=200,N.castShadow=!0,N.shadow.mapSize.width=512,N.shadow.mapSize.height=512,N.shadow.camera.near=10,N.shadow.camera.far=200,N.shadow.focus=1,w.add(N),f.position.z=5;return function e(){if(requestAnimationFrame(e),b){y.rotation.y-=.001;for(const e of y.children)e instanceof i&&"CircleGeometry"===e.geometry.type&&(e.rotation.y+=.001)}v.render(w,f)}(),p((()=>{document.getElementById("canvas").appendChild(v.domElement)})),{}}});const S={id:"canvas"};function x(e,n,o){console.log(`Found (${e}): ${n.name}, "${n.location}" -> "${o.city}", "${o.adminName}", "${o.country}" (${o.lat}, ${o.lng})`)}U.render=function(e,n,o,t,a,r){return f(),w("div",S)};var z=e({name:"App",components:{ThreeCanvas:U},setup(){const e=v(""),n=v("vitejs"),o=v("vite"),t=v([]),a=v(),r=[],l=e=>{let n;const{location:o}=e;if(!o)return n;let t=999;for(const a of r)a.city===o&&t>1?(n={lat:a.lat,lng:a.lng},t=1,x(t,e,a)):a.adminName===o&&t>2?(n={lat:a.lat,lng:a.lng},t=2,x(t,e,a)):a.country===o&&t>3?(n={lat:a.lat,lng:a.lng},t=3,x(t,e,a)):o.includes(a.city)&&t>4?(n={lat:a.lat,lng:a.lng},t=4,x(t,e,a)):a.adminName&&o.includes(a.adminName)&&t>5?(n={lat:a.lat,lng:a.lng},t=5,x(t,e,a)):o.includes(a.country)&&t>6&&(n={lat:a.lat,lng:a.lng},t=6,x(t,e,a));return n};return u([e,n,o],(async()=>{t.value=[],a.value=void 0;try{const a=await E("\n              query ($repoOwner: String!, $repoName: String!) {\n                repository(owner: $repoOwner, name: $repoName) {\n                  collaborators {\n                    nodes {\n                      id\n                      login\n                      name\n                      avatarUrl\n                      location\n                      url\n                    }\n                    pageInfo {\n                      hasNextPage\n                    }\n                    totalCount\n                  }\n                  mentionableUsers(first: 10) {\n                    nodes {\n                      id\n                      login\n                      name\n                      avatarUrl\n                      location\n                      url\n                    }\n                    pageInfo {\n                      hasNextPage\n                    }\n                    totalCount\n                  }\n                }\n              }\n            ",{headers:{authorization:`token ${e.value}`},repoOwner:n.value,repoName:o.value});t.value=a.repository.collaborators.nodes;for(const e of t.value)e.geolocation=l(e)}catch(r){console.error(r),a.value=r.message}}),{immediate:!0}),p((()=>{(function(e,n){if(!n||0===n.length)return e();if(void 0===P){const e=document.createElement("link").relList;P=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(n.map((e=>{if((e=`/github-contributors-map/${e}`)in T)return;T[e]=!0;const n=e.endsWith(".css"),o=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${o}`))return;const t=document.createElement("link");return t.rel=n?"stylesheet":P,n||(t.as="script",t.crossOrigin=""),t.href=e,document.head.appendChild(t),n?new Promise(((e,n)=>{t.addEventListener("load",e),t.addEventListener("error",n)})):void 0}))).then((()=>e()))})((()=>import("./worldcities.46d1bbb9.js")),[]).then((e=>{r.push(...e.default)}))})),{githubToken:e,repoOwner:n,repoName:o,collaborators:t,errorMessage:a}}});const I=y("h1",null,"GitHub Contributors Map",-1),L=y("label",{for:"personal-github-token"},"Your GitHub Token:",-1),A=y("label",{for:"repo-owner"},"Repository Owner:",-1),j=y("label",{for:"repo-name"},"Repository Name:",-1),q=y("h2",null,"Collaborators",-1),V=y("thead",null,[y("tr",null,[y("th",null,"Avatar"),y("th",null,"Login"),y("th",null,"Name"),y("th",null,"Location"),y("th",null,"URL"),y("th",null,"Geolocation")])],-1);z.render=function(e,n,o,t,a,r){const l=M("ThreeCanvas");return f(),w($,null,[I,y("div",null,[y("form",null,[L,b(y("input",{id:"personal-github-token","onUpdate:modelValue":n[1]||(n[1]=n=>e.githubToken=n),name:"personal-github-token"},null,512),[[k,e.githubToken]]),A,b(y("input",{id:"repo-owner","onUpdate:modelValue":n[2]||(n[2]=n=>e.repoOwner=n),name:"repo-owner",placeholder:"owner"},null,512),[[k,e.repoOwner]]),j,b(y("input",{id:"repo-name","onUpdate:modelValue":n[3]||(n[3]=n=>e.repoName=n),name:"repo-name",placeholder:"name"},null,512),[[k,e.repoName]])])]),e.errorMessage?(f(),w("span",{key:1,textContent:C(e.errorMessage)},null,8,["textContent"])):(f(),w($,{key:0},[q,y(l,{users:e.collaborators},null,8,["users"]),y("table",null,[V,y("tbody",null,[(f(!0),w($,null,N(e.collaborators,(e=>(f(),w("tr",{key:e.id},[y("td",null,[y("img",{src:e.avatarUrl,width:"128"},null,8,["src"])]),y("td",null,C(e.login),1),y("td",null,C(e.name),1),y("td",null,C(e.location),1),y("td",null,C(e.url),1),y("td",null,C(e.geolocation),1)])))),128))])])],64))],64)},O(z).mount("#app");
